<article class="contentHolder" ng-if="userIsSignedIn">

	<menu>
		<li>
			<h5>My Tasks</h5>
			<ul class="taskList">
				<li ng-repeat="thisTask in user.tasks" class="taskList__holder" ng-click="view(thisTask.task.location, thisTask.id)">
					<div >{{ thisTask.task.title }} (started {{ thisTask.started | fromNow }})</div>
				</li>
			</ul>
		</li>

		<li>
			<h5>Messages</h5>
			<ul class="taskList">
				<li ng-repeat="task in user.notify" class="taskList__holder">
					<div ng-repeat="note in task">

						<h5 ng-if="$index === 0" ng-click="view(note.task.location, note.task.id)">{{ note.task.title}}</h5>

						<note>
							<p ng-click="view(note.task.location, note.task.id)">{{ note.message }}</p>
							<span>{{ note.date | fromNow }}</span>
							<span class="btn btn-xs btn-default"
								  ng-click="removeNote(note)">
									remove note</span>
						</note>
					</div>
				</li>
			</ul>
		</li>

		<li ng-click="logout()">Logout</li>
	</menu>

	<h1 ng-show="user.name">
		<small>Welcome</small>
		<span>{{ user.name }}</span>
		<small>{{ user.email }}</small><br>
		<small>org: {{ user.organisation }}</small>
	</h1>

	<h1 ng-show="allTasks && allTasks.length > 0"
		class="ucase">
		{{ user.organisation }}'s Task List
			<a ng-show="allTasks" href="index.html#!/dashboard/create" class="btn btn-primary">
				create task</a></h1>


	<section class="contentHolder__btn-holder"><!-- ng-show="allTasks && allTasks.length > 0"-->
		<span ng-show="allTasks.length > 6">
			Filter 
			<a ng-repeat="thisFilter in allFilters"
				class="btn btn-sm btn-default {{ current.params.filter === thisFilter ? 'active' : ''}}"
				href="index.html#!/dashboard/{{ thisFilter }}">
				{{ thisFilter }}
			</a>
			<br><br>
		</span>
	
		<ul class="taskList">
			<li ng-repeat="thisTask in allTasks.active" class="taskList__holder" ng-click="view('active', thisTask.id)">
				<a 	class="taskList__holder--title status__{{ thisTask.status}} urgency__{{ thisTask.urgency }}">
					{{ thisTask.title }}
				</a><br>
				<div class="taskList__holder--user status__{{ thisTask.status }} urgency__{{ thisTask.urgency }}">
					{{ thisTask.username }}
					(<i>{{ thisTask.status }}</i>) </div>
			</li>
		</ul>
	</section>


	<h3 ng-show="allTasks.length === 0"><br>No Todos for Today
		<a href="index.html#!/dashboard/create" class="btn btn-primary">
			create a new task</a>
	</h3>
	<h3 ng-show="!allTasks"><br>Loading</h3>

	<todo model="currentTask" filters="taskFilters" member="user"></todo>

</article>

<article ng-if="!userIsSignedIn">
	<h1>Goodbye, <br>see you soon :)</h1>
</article>